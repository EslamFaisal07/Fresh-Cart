import './polyfills.server.mjs';
import{b as N}from"./chunk-JOP2E7BM.mjs";import{a as y,b as u,c as b,d as F,f as T,g as V,h as L,i as q,k as R}from"./chunk-YT36GN5F.mjs";import"./chunk-CBYSDMSX.mjs";import{l as P}from"./chunk-SAMTZIPV.mjs";import"./chunk-6M3AHHX6.mjs";import{Ab as _,Ib as s,Jb as v,Qa as a,Qb as S,Y as C,aa as h,gb as d,ib as c,ka as f,la as g,mb as m,qb as o,rb as n,sb as p,vb as x,zb as w}from"./chunk-UAZOSIRX.mjs";import"./chunk-VVCT4QZE.mjs";function A(e,r){e&1&&(o(0,"p",8),s(1,"Email is Required ."),n())}function G(e,r){e&1&&(o(0,"p",8),s(1,"Enter Valid Email ."),n())}function D(e,r){if(e&1&&(o(0,"div",5),d(1,A,2,0,"p",8)(2,G,2,0),n()),e&2){let t,i=_(2);a(),m(1,(t=i.verifyEmail.get("email"))!=null&&t.getError("required")?1:(t=i.verifyEmail.get("email"))!=null&&t.getError("email")?2:-1)}}function B(e,r){e&1&&(o(0,"span"),p(1,"i",9),n())}function I(e,r){if(e&1&&(o(0,"p",7),s(1),n()),e&2){let t=_(2);a(),v(t.msgError)}}function M(e,r){if(e&1){let t=x();o(0,"form",2),w("ngSubmit",function(){f(t);let l=_();return g(l.emailSubmit())}),o(1,"div")(2,"label",3),s(3,"Email"),n(),p(4,"input",4),d(5,D,3,1,"div",5),n(),o(6,"button",6),s(7,"Verify Email "),d(8,B,2,0,"span"),n(),d(9,I,2,1,"p",7),n()}if(e&2){let t,i=_();c("formGroup",i.verifyEmail),a(5),m(5,(t=i.verifyEmail.get("email"))!=null&&t.errors&&((t=i.verifyEmail.get("email"))!=null&&t.touched||(t=i.verifyEmail.get("email"))!=null&&t.dirty)?5:-1),a(),c("disabled",i.verifyEmail.invalid),a(2),m(8,i.isLoading?8:-1),a(),m(9,i.msgError?9:-1)}}function k(e,r){e&1&&(o(0,"p",8),s(1,"resetCode is Required ."),n())}function $(e,r){e&1&&(o(0,"p",8),s(1,"Enter A Valid Code ."),n())}function j(e,r){if(e&1&&(o(0,"div",5),d(1,k,2,0,"p",8)(2,$,2,0),n()),e&2){let t,i=_(2);a(),m(1,(t=i.verifyCode.get("resetCode"))!=null&&t.getError("required")?1:(t=i.verifyCode.get("resetCode"))!=null&&t.getError("pattern")?2:-1)}}function O(e,r){e&1&&(o(0,"span"),p(1,"i",9),n())}function U(e,r){if(e&1&&(o(0,"p",7),s(1),n()),e&2){let t=_(2);a(),v(t.msgError)}}function z(e,r){if(e&1){let t=x();o(0,"form",2),w("ngSubmit",function(){f(t);let l=_();return g(l.codeSubmit())}),o(1,"div")(2,"label",10),s(3,"resetCode"),n(),p(4,"input",11),d(5,j,3,1,"div",5),n(),o(6,"button",6),s(7,"Verify Code "),d(8,O,2,0,"span"),n(),d(9,U,2,1,"p",7),n()}if(e&2){let t,i=_();c("formGroup",i.verifyCode),a(5),m(5,(t=i.verifyCode.get("resetCode"))!=null&&t.errors&&((t=i.verifyCode.get("resetCode"))!=null&&t.touched||(t=i.verifyCode.get("resetCode"))!=null&&t.dirty)?5:-1),a(),c("disabled",i.verifyCode.invalid),a(2),m(8,i.isLoading?8:-1),a(),m(9,i.msgError?9:-1)}}function H(e,r){e&1&&(o(0,"p",8),s(1,"Email is Required ."),n())}function J(e,r){e&1&&(o(0,"p",8),s(1,"Enter Valid Email ."),n())}function K(e,r){if(e&1&&(o(0,"div",5),d(1,H,2,0,"p",8)(2,J,2,0),n()),e&2){let t,i=_(2);a(),m(1,(t=i.resetPassword.get("email"))!=null&&t.getError("required")?1:(t=i.resetPassword.get("email"))!=null&&t.getError("email")?2:-1)}}function Q(e,r){e&1&&(o(0,"p",8),s(1,"password is Required ."),n())}function W(e,r){e&1&&(o(0,"p",8),s(1,"password must start with upperCase then from 6 to more any chars ."),n())}function X(e,r){if(e&1&&(o(0,"div",5),d(1,Q,2,0,"p",8)(2,W,2,0),n()),e&2){let t,i=_(2);a(),m(1,(t=i.resetPassword.get("newPassword"))!=null&&t.getError("required")?1:(t=i.resetPassword.get("newPassword"))!=null&&t.getError("pattern")?2:-1)}}function Y(e,r){e&1&&(o(0,"span"),p(1,"i",9),n())}function Z(e,r){if(e&1&&(o(0,"p",7),s(1),n()),e&2){let t=_(2);a(),v(t.msgError)}}function ee(e,r){if(e&1){let t=x();o(0,"form",2),w("ngSubmit",function(){f(t);let l=_();return g(l.ResetPasswordSubmit())}),o(1,"div")(2,"label",3),s(3,"Email"),n(),p(4,"input",12),d(5,K,3,1,"div",5),n(),o(6,"div")(7,"label",13),s(8,"newPassword"),n(),p(9,"input",14),d(10,X,3,1,"div",5),n(),o(11,"button",6),s(12,"Reset Password "),d(13,Y,2,0,"span"),n(),d(14,Z,2,1,"p",7),n()}if(e&2){let t,i,l=_();c("formGroup",l.resetPassword),a(5),m(5,(t=l.resetPassword.get("email"))!=null&&t.errors&&((t=l.resetPassword.get("email"))!=null&&t.touched||(t=l.resetPassword.get("email"))!=null&&t.dirty)?5:-1),a(5),m(10,(i=l.resetPassword.get("newPassword"))!=null&&i.errors&&((i=l.resetPassword.get("newPassword"))!=null&&i.touched||(i=l.resetPassword.get("newPassword"))!=null&&i.dirty)?10:-1),a(),c("disabled",l.resetPassword.invalid),a(2),m(13,l.isLoading?13:-1),a(),m(14,l.msgError?14:-1)}}var se=(()=>{let r=class r{constructor(){this.msgError="",this.isLoading=!1,this._FormBuilder=C(q),this._AuthService=C(N),this._Router=C(P),this.step=1,this.verifyEmail=this._FormBuilder.group({email:[null,[u.required,u.email]]}),this.verifyCode=this._FormBuilder.group({resetCode:[null,[u.required,u.pattern(/^[0-9]{6}$/)]]}),this.resetPassword=this._FormBuilder.group({email:[null,[u.required,u.email]],newPassword:[null,[u.required,u.pattern(/^\w{6,}$/)]]})}emailSubmit(){this.isLoading=!0;let i=this.verifyEmail.get("email")?.value;this.resetPassword.get("email")?.patchValue(i),this.emailSubscribe=this._AuthService.setEmailVerify(this.verifyEmail.value).subscribe({next:l=>{console.log(l),l.statusMsg=="success"&&(this.step=2,this.isLoading=!1)},error:l=>{console.log(l),this.msgError=l.error.message,this.isLoading=!1}})}codeSubmit(){this.isLoading=!0,this.emailSubscribe=this._AuthService.setCodeVerify(this.verifyCode.value).subscribe({next:i=>{i.status=="Success"&&(this.step=3,this.isLoading=!1)},error:i=>{this.msgError=i.error.message,this.isLoading=!1}})}ResetPasswordSubmit(){this.isLoading=!0,this.emailSubscribe=this._AuthService.setResetPassword(this.resetPassword.value).subscribe({next:i=>{localStorage.setItem("userToken",i.token),this._AuthService.saveUserData(),this._Router.navigate(["/home"]),this.isLoading=!1},error:i=>{this.msgError=i.error.message,this.isLoading=!1}})}ngOnDestroy(){this.emailSubscribe.unsubscribe()}};r.\u0275fac=function(l){return new(l||r)},r.\u0275cmp=h({type:r,selectors:[["app-forget-password"]],standalone:!0,features:[S],decls:6,vars:1,consts:[[1,"text-center","text-main","my-4"],[1,"bg-main-light","rounded-4","p-3","shadow",3,"formGroup"],[1,"bg-main-light","rounded-4","p-3","shadow",3,"ngSubmit","formGroup"],["for","email"],["formControlName","email","id","email","type","email",1,"form-control"],[1,"alert","alert-danger","w-100"],[1,"btn-main","d-block","ms-auto","mt-3",3,"disabled"],[1,"alert","alert-danger","my-3"],[1,"m-0"],[1,"fas","fa-spin","fa-spinner"],["for","resetCode"],["formControlName","resetCode","id","resetCode","type","text",1,"form-control"],["readonly","","formControlName","email","id","email","type","email",1,"form-control"],["for","newPassword"],["formControlName","newPassword","id","newPassword","type","password",1,"form-control"]],template:function(l,E){l&1&&(o(0,"section")(1,"h1",0),s(2,"Forget Password"),n(),d(3,M,10,5,"form",1)(4,z,10,5)(5,ee,15,6),n()),l&2&&(a(3),m(3,E.step==1?3:E.step==2?4:E.step==3?5:-1))},dependencies:[R,T,y,b,F,V,L]});let e=r;return e})();export{se as ForgetPasswordComponent};
